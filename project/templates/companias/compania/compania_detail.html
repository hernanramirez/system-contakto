{% extends 'partials/base.html' %}
{% load static crispy_forms_tags %}

{% block title %}DataTables{% endblock title %}

{% block content %}

<!-- ============================================================== -->
<!-- Start right Content here -->
<!-- ============================================================== -->
<div class="main-content">

  <div class="page-content">
    <div class="container-fluid">

      <!-- start page title -->
      <div class="row">
        <div class="col-12">
          <div class="page-title-box d-sm-flex align-items-center justify-content-between">
            <h4 class="mb-sm-0 font-size-18">Clientes</h4>

            <div class="page-title-right">
              <ol class="breadcrumb m-0">
                <li class="breadcrumb-item"><a href="javascript: void(0);">Dashboard</a></li>
                <li class="breadcrumb-item"><a href="{% url 'companias_list' %}">Listado de clientes</a></li>
                <li class="breadcrumb-item active">Detalles</li>
              </ol>
            </div>

          </div>
        </div>
      </div>
      <!-- end page title -->


      <div class="card" id="card_detalle_compania">
        
        <div class="card-header">
          <div class="row">
            <div class="col-md-12">
              <h4 class="card-title">Detalle del cliente</h4>
            </div>
          </div>
        </div>
        
        <div class="card-body">

          <div class="table-responsive">
            <table class="table table-striped mb-0">
              <tbody>
                <tr>
                  <td>Nombre:</td>
                  <td>{{ compania.nombre }} </td>
                </tr>

                <tr>
                  <td>Teléfono:</td>
                  <td>{{ compania.telefono }}</td>
                </tr>

                <tr>
                  <td>Teléfono alterno:</td>
                  <td>{{ compania.telefono_alt }}</td>
                </tr>

                <tr>
                  <td>Email:</td>
                  <td>{{ compania.email }}</td>
                </tr>

                <tr>
                  <td>Giro:</td>
                  <td>{{ compania.role }}</td>
                </tr>

                <tr>
                  <td>Dirección fiscal:</td>
                  <td>{{ compania.rfc_direccion }}</td>
                </tr>

                <tr>
                  <td>RFC:</td>
                  <td>{{ compania.rfc }}</td>
                </tr>

                <tr>
                  <td>Razón social:</td>
                  <td>{{ compania.razon_social }}</td>
                </tr>

                <tr>
                  <td>Coordinador de Atención a Clientes:</td>
                  <td>{{ compania.coordinador_ejecutivos }}</td>
                </tr>

                <!-- <tr>
                  <td>Es Cliene:</td>
                  <td>{{ compania.es_cliente }}</td>
                </tr> -->

                <tr>
                  <td>Notas:</td>
                  <td>{{ compania.rfc }}</td>
                </tr>

                <tr>
                  <td>Fecha de creación:</td>
                  <td>{{ compania.fecha_creacion }}</td>
                </tr>

              </tbody>
            </table>
          </div><!-- end div responsive -->

          <br>

          <div class="d-flex flex-wrap gap-2">
            <a href="{% url 'companias_update' compania.pk %}" class="btn btn-primary waves-effect btn-label waves-light"><i class="bx bx-edit label-icon"></i>Editar</a>
            <a href="{% url 'companias_delete' compania.pk %}" class="btn btn-danger waves-effect btn-label waves-light"><i class="bx bx-trash label-icon"></i> Eliminar</a>
        </div>
   

        </div> <!-- end card-body -->
      </div> <!-- end card -->


      <div class="card" id="card_compania_suscursales">
        
        <div class="card-header">
          <div class="row">
            <div class="col-md-12">
              <h4 class="card-title">Sucursales</h4>
            </div>
          </div>
        </div>
        
        <div class="card-body">

          <div class="table-responsive">
            <table class="table table-striped mb-0">
              <thead>
                <tr>
                  <th>Acciones</th>
                  <th>Nombre</th>
                  <th>Ciudad</th>
                  <th>Teléfono</th>
                  <th>Email</th>
                  <th>Estado</th>
                  <th>Municipio</th>
                </tr>
              <tbody>

                {% for sucursal in compania.sucursales.all %}

                <tr>
                  <td>
                    <a href="{% url 'companias_sucursal_update' compania.pk sucursal.pk %}" alt="Editar" class="btn btn-soft-primary waves-effect waves-light"><i class="bx bx-edit font-size-16 align-middle"></i></a>
                    <a href="{% url 'companias_sucursal_delete' compania.pk sucursal.pk %}" alt="Eliminar" class="btn btn-soft-danger waves-effect waves-light"><i class="bx bx-trash font-size-16 align-middle"></i></a>
                  </td>
                  <td>{{ sucursal.nombre }}</td>
                  <td>{{ sucursal.ciudad }} </td>
                  <td>{{ sucursal.telefono }} </td>
                  <td>{{ sucursal.email }} </td>
                  <td>{{ sucursal.estado }} </td>
                  <td>{{ sucursal.municipio }} </td>
                 
                </tr>

                {% empty %}
                <tr>
                  <td colspan="5">No hay sucursales registradas</td>
                </tr>  
                  
                {% endfor %}

              </tbody>
            </table>
          </div><!-- end div responsive -->

          <br>

          <div class="d-flex flex-wrap gap-2">
            <a href="{% url 'companias_sucursal_create' compania.pk %}" class="btn btn-primary waves-effect btn-label waves-light"><i class="bx bx-plus label-icon"></i>Agregar sucursal</a>
        </div>
   

        </div> <!-- end card-body -->
      </div> <!-- end card -->

      <div class="card" id="card_compania_direcciones_fiscales">
        
        <div class="card-header">
          <div class="row">
            <div class="col-md-12">
              <h4 class="card-title">Datos fiscales</h4>
            </div>
          </div>
        </div>
        
        <div class="card-body">

          <div class="table-responsive">
            <table class="table table-striped mb-0">
              <thead>
                <tr>
                  <th>Acciones</th>
                  <th>Régimen fiscal</th>
                  <th>RFC</th>
                  <th>Nombre</th>
                  <th>Dirección</th>
                  <th>Código postal</th>
                  <th>Estado</th>
                  <th>Municipio</th>
                  <th>Activo</th>
                </tr>
              <tbody>

                {% for direccion_fiscal in compania.direcciones_fiscales.all %}

                <tr>
                  <td>
                    <a href="{% url 'companias_direccion_fiscal_update' compania.pk direccion_fiscal.pk %}" alt="Editar" class="btn btn-soft-primary waves-effect waves-light"><i class="bx bx-edit font-size-16 align-middle"></i></a>
                    <a href="{% url 'companias_direccion_fiscal_delete' compania.pk direccion_fiscal.pk %}" alt="Eliminar" class="btn btn-soft-danger waves-effect waves-light"><i class="bx bx-trash font-size-16 align-middle"></i></a>
                  </td>
                  <td>{{ direccion_fiscal.regimen_fiscal }}</td>
                  <td>{{ direccion_fiscal.rfc }} </td>
                  <td>{{ direccion_fiscal.nombre }} </td>
                  <td>{{ direccion_fiscal.direccion }} </td>
                  <td>{{ direccion_fiscal.codigo_postal }} </td>
                  <td>{{ direccion_fiscal.estado }} </td>
                  <td>{{ direccion_fiscal.municipio }} </td>
                  <td>{{ direccion_fiscal.activo }} </td>

                </tr>

                {% empty %}
                <tr>
                  <td colspan="5">No hay datos fiscales registradas</td>
                </tr>  
                  
                {% endfor %}

              </tbody>
            </table>
          </div><!-- end div responsive -->

          <br>

          <div class="d-flex flex-wrap gap-2">
            <a href="{% url 'companias_direccion_fiscal_create' compania.pk %}" class="btn btn-primary waves-effect btn-label waves-light"><i class="bx bx-plus label-icon"></i>Agregar datos fiscales</a>
        </div>
   

        </div> <!-- end card-body -->
      </div> <!-- end card -->

      <div class="card" id="card_compania_contactos">
        
        <div class="card-header">
          <div class="row">
            <div class="col-md-12">
              <h4 class="card-title">Contactos</h4>
            </div>
          </div>
        </div>
        
        <div class="card-body">

          <div class="table-responsive">
            <table class="table table-striped mb-0">
              <thead>
                <tr>
                  <th>Nombre</th>
                  <th>Email</th>
                  <th>Teléfono</th>
                </tr>
              <tbody>

                {% for cliente in clientes %}

                <tr>
                  <td>{{ cliente.first_name }} {{ cliente.last_name}} </td>
                  <td>{{ cliente.email }} </td>
                  <td>{{ cliente.telefono }} </td>
                </tr>

                {% empty %}
                
                <tr>
                  <td colspan="3">No hay contactos registrados</td>
                </tr>
                  
                {% endfor %}

              </tbody>
            </table>
          </div><!-- end div responsive -->

          <br>

          
          {% comment %}
            <div class="d-flex flex-wrap gap-2">
              <a href="{% url 'companias_contacto_create' compania.pk %}" class="btn btn-primary waves-effect btn-label waves-light"><i class="bx bx-plus label-icon"></i>Agregar contacto</a>
          </div>
          {% endcomment %}
            
   

        </div> <!-- end card-body -->
      </div> <!-- end card -->


      <a href="{% url 'companias_list' %}" class="btn btn-warning waves-effect btn-label waves-light"> <i
        class="bx bx-user-x label-icon"></i>
      Regresar al listado</a>
      <br><br>

    </div> <!-- container-fluid -->
  </div>
  <!-- End Page-content -->

  {% block footer %}
  {% include 'partials/footer.html' %}
  {% endblock footer %}
</div>
<!-- end main content-->
{% endblock content %}